# 📚 Chinese Historical Documents Assistant(CHDA)

## 中国历史文献推荐小助手

基于 `DGL（Deep Graph Library）` 框架训练模型，内置了自采数据集、训练过程、评测过程以及一个小应用。

## 快速开始

```python
pip install dgl torch gensim fasttext
```

框架参考：[https://www.dgl.ai/pages/start.html](https://www.dgl.ai/pages/start.html)

## 数据集

目前提供一个简单的历史类文献引用的数据集，并给定了每篇文献一个特定的 `UUID` 以便识别。可按照格式，自行导出自有数据集到 `paper.json`，由于目前下游任务为链接预测，故在训练样本的正样本直接使用了全量的数据集，负样本则自动补齐算出相同的不存在的链接，以供模型训练过程中进行验证与比对。

### 数据准备

数据集的准备，除了要正确获取各个文章与其引用与被引用的情况，还需要判定好文章中的消歧过程，即相同文章之间不能有重复建立的情况，可考虑自行嵌入 `UUID` 或获取文章的 `DOI` 号来识别。或前期可简单的利用引用的全称，如："中国营造学社西南编年事辑（1937—1940）——长沙、昆明[J]. 冯棣;黄沁雅;黄福丹.建筑史学刊,2023(02)"来作为唯一值判定。

## 主函数

### 特征处理

在模型训练的特征处理中，目前提取：标题+发表年份+期刊名+作者名+摘要。目前仅提供了一个非常基础的文本特征处理方式（`fasttext`）与热编码(`one-hot`)，在实际应用中，您可能需要使用更高级的文本表示方法，如 `TF-IDF`、`Word2Vec` 或 `BERT` 等。

### 二部图模拟

此外，超边到图的转换过程也需要根据您具体的数据结构和需求来设计。目前直接做了二部图，将超图转为了标准图来做的（这样也解决了引用方向的问题）相当于降维再跑 `GNN` 里的 `GraphConv`。

如：一篇文章引用了若干文献，则这篇文章为单个文章节点，与其引用的文献节点组中，用一个额外的独立节点作为抽象超边进行连接，即一头被这篇文章连接，一头连接这篇文章所引用的文献组。

即：文章（单节点） -> 超边（单节点） -> 文献组（若干节点）

为方便理解，这里还贴出一份超图转为标准图后的模拟结构（以 `Neo4j` 举例）：

1. 创建代表文章的节点。
2. 创建代表超边的节点，用于连接文章和其引用的文献。
3. 创建代表引用文献的节点。
4. 建立从文章到超边的有向边，再从超边到每个引用文献的有向边。

```cypher
CREATE (paper:Paper {id: "文章 UUID"})-[:HAS_REFERENCE]->(refEdge:ReferenceEdge {id: "超边 UUID"})
CREATE (refEdge)-[:REFERENCES]->(:Document {id: "文献1 UUID"})
CREATE (refEdge)-[:REFERENCES]->(:Document {id: "文献2 UUID"})
```

在这个模型中，`Paper`节点代表文章本身，`ReferenceEdge`节点作为超边连接文章和所有引用的文献，而`Document`节点代表引用的各个文献。

## 训练与验证

```python
python train_dgl.py
```

## 小应用

`WIP`

## Roadmap

- [x] 文本特征的预处理：对于文本类特征（如标题和摘要），通常需要通过自然语言处理技术将其转换为数值型特征向量，常用的方法包括 TF-IDF、Word2Vec、BERT 等。
- [x] 特征工程：对于类别型特征（如作者），可以使用独热编码(one-hot)等技术。此外，还可以设计特定的特征，如基于引用数量的特征，来捕捉节点的影响力等属性。
- [x] 模型设计：设计图神经网络模型时，需要考虑如何有效整合节点特征和图结构信息。这可能涉及选择合适的图卷积层、激活函数、以及正则化技术等。
- [ ] 配套小应用示例
